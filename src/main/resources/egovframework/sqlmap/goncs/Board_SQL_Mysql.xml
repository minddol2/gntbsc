<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >

<sqlMap namespace="Boardss">
    
<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="Board" type="egovframework.goncs.bbs.service.Board"/>
	<typeAlias  alias="BoardVO" type="egovframework.goncs.bbs.service.BoardVO"/>

	<resultMap id="boardList" class="egovframework.goncs.bbs.service.BoardVO">
		<result property="bbsId" column="BBS_ID" columnIndex="1"/>
		<result property="nttId" column="NTT_ID" columnIndex="2"/>
		<result property="nttSj" column="NTT_SJ" columnIndex="3"/>
		<result property="frstRegisterId" column="FRST_REGISTER_ID" columnIndex="4"/>
		<result property="frstRegisterNm" column="FRST_REGISTER_NM" columnIndex="5"/>
		<result property="frstRegisterPnttm" column="FRST_REGIST_PNTTM" columnIndex="6"/>
		<result property="inqireCo" column="RDCNT" columnIndex="7"/>
		<result property="parnts" column="PARNTSCTT_NO" columnIndex="8"/>
		<result property="replyAt" column="ANSWER_AT" columnIndex="9"/>		
		<result property="replyLc" column="ANSWER_LC" columnIndex="10"/>
		<result property="useAt" column="USE_AT" columnIndex="11"/>
		<result property="atchFileId" column="ATCH_FILE_ID" columnIndex="12"/>
		<result property="ntceBgnde" column="NTCE_BGNDE" columnIndex="13"/>
		<result property="ntceEndde" column="NTCE_ENDDE" columnIndex="14"/>
		<result property="fileSn" column="FILE_SN" columnIndex="15"/>
		<result property="nttCn" column="NTT_CN" columnIndex="16"/>
		<result property="category" column="CATEGORY" columnIndex="17"/>
		<result property="ssWords" column="SSWORDS" columnIndex="18"/>
		<result property="sizex" column="SIZEX" columnIndex="19"/>
		<result property="sizey" column="SIZEY" columnIndex="20"/>
		<result property="leftx" column="LEFTX" columnIndex="21"/>
		<result property="lefty" column="LEFTY" columnIndex="22"/>
		<result property="link_url" column="LINK_URL" columnIndex="23"/>
		<result property="topx" column="TOPX" columnIndex="24"/>
		<result property="category2" column="CATEGORY2" columnIndex="25"/>
		<result property="classfication" column="CLASSFICATION" columnIndex="26"/>
		<result property="classfication2" column="CLASSFICATION2" columnIndex="27"/>
	</resultMap>
	
	<resultMap id="cboardList" class="egovframework.goncs.bbs.service.BoardVO">
		<result property="bbsId" column="BBS_ID" columnIndex="1"/>
		<result property="nttId" column="NTT_ID" columnIndex="2"/>
		<result property="nttSj" column="NTT_SJ" columnIndex="3"/>
		<result property="frstRegisterId" column="FRST_REGISTER_ID" columnIndex="4"/>
		<result property="frstRegisterNm" column="FRST_REGISTER_NM" columnIndex="5"/>
		<result property="frstRegisterPnttm" column="FRST_REGIST_PNTTM" columnIndex="6"/>
		<result property="inqireCo" column="RDCNT" columnIndex="7"/>
		<result property="parnts" column="PARNTSCTT_NO" columnIndex="8"/>
		<result property="replyAt" column="ANSWER_AT" columnIndex="9"/>		
		<result property="replyLc" column="ANSWER_LC" columnIndex="10"/>
		<result property="useAt" column="USE_AT" columnIndex="11"/>
		<result property="atchFileId" column="ATCH_FILE_ID" columnIndex="12"/>
		<result property="ntceBgnde" column="NTCE_BGNDE" columnIndex="13"/>
		<result property="ntceEndde" column="NTCE_ENDDE" columnIndex="14"/>
		<result property="fileSn" column="FILE_SN" columnIndex="15"/>
		<result property="category" column="CATEGORY" columnIndex="16"/>
		<result property="ssWords" column="SSWORDS" columnIndex="17"/>
		<result property="sizex" column="SIZEX" columnIndex="18"/>
		<result property="sizey" column="SIZEY" columnIndex="19"/>
		<result property="leftx" column="LEFTX" columnIndex="20"/>
		<result property="lefty" column="LEFTY" columnIndex="21"/>
		<result property="link_url" column="LINK_URL" columnIndex="21"/>
		<result property="topx" column="TOPX" columnIndex="24"/>
	</resultMap>

	<resultMap id="qnaList" class="egovframework.goncs.bbs.service.BoardVO">
		<result property="bbsId" column="BBS_ID" columnIndex="1"/>
		<result property="nttId" column="NTT_ID" columnIndex="2"/>
		<result property="nttSj" column="NTT_SJ" columnIndex="3"/>
		<result property="frstRegisterId" column="FRST_REGISTER_ID" columnIndex="4"/>
		<result property="frstRegisterNm" column="FRST_REGISTER_NM" columnIndex="5"/>
		<result property="frstRegisterPnttm" column="FRST_REGIST_PNTTM" columnIndex="6"/>
		<result property="inqireCo" column="RDCNT" columnIndex="7"/>
		<result property="parnts" column="PARNTSCTT_NO" columnIndex="8"/>
		<result property="replyAt" column="ANSWER_AT" columnIndex="9"/>		
		<result property="replyLc" column="ANSWER_LC" columnIndex="10"/>
		<result property="useAt" column="USE_AT" columnIndex="11"/>
		<result property="atchFileId" column="ATCH_FILE_ID" columnIndex="12"/>
		<result property="ntceBgnde" column="NTCE_BGNDE" columnIndex="13"/>
		<result property="ntceEndde" column="NTCE_ENDDE" columnIndex="14"/>
		<result property="reply_cnt" column="REPLY_CNT" columnIndex="15"/>
	</resultMap>
			
	<resultMap id="faqList" class="egovframework.goncs.bbs.service.BoardVO">
		<result property="bbsId" column="BBS_ID" columnIndex="1"/>
		<result property="nttId" column="NTT_ID" columnIndex="2"/>
		<result property="nttSj" column="NTT_SJ" columnIndex="3"/>
		<result property="frstRegisterId" column="FRST_REGISTER_ID" columnIndex="4"/>
		<result property="frstRegisterNm" column="FRST_REGISTER_NM" columnIndex="5"/>
		<result property="frstRegisterPnttm" column="FRST_REGIST_PNTTM" columnIndex="6"/>
		<result property="inqireCo" column="RDCNT" columnIndex="7"/>
		<result property="parnts" column="PARNTSCTT_NO" columnIndex="8"/>
		<result property="replyAt" column="ANSWER_AT" columnIndex="9"/>		
		<result property="replyLc" column="ANSWER_LC" columnIndex="10"/>
		<result property="useAt" column="USE_AT" columnIndex="11"/>
		<result property="atchFileId" column="ATCH_FILE_ID" columnIndex="12"/>
		<result property="ntceBgnde" column="NTCE_BGNDE" columnIndex="13"/>
		<result property="ntceEndde" column="NTCE_ENDDE" columnIndex="14"/>
		<result property="nttCn" column="NTT_CN" columnIndex="15"/>
	</resultMap>

	<resultMap id="boardDetail" class="egovframework.goncs.bbs.service.BoardVO">
		<result property="bbsId" column="BBS_ID" columnIndex="1"/>
		<result property="nttId" column="NTT_ID" columnIndex="2"/>
		<result property="nttSj" column="NTT_SJ" columnIndex="3"/>	
		<result property="ntcrId" column="NTCR_ID" columnIndex="4"/>
		<result property="ntcrNm" column="NTCR_NM" columnIndex="5"/>
		<result property="nttNo" column="NTT_NO" columnIndex="6"/>
		<result property="nttCn" column="NTT_CN" columnIndex="7"/>
		<result property="password" column="PASSWORD" columnIndex="8"/>
		<result property="frstRegisterId" column="FRST_REGISTER_ID" columnIndex="9"/>
		<result property="frstRegisterNm" column="FRST_REGISTER_NM" columnIndex="10"/>
		<result property="frstRegisterPnttm" column="FRST_REGIST_PNTTM" columnIndex="11"/>
		<result property="ntceBgnde" column="NTCE_BGNDE" columnIndex="12"/>
		<result property="ntceEndde" column="NTCE_ENDDE" columnIndex="13"/>
		<result property="inqireCo" column="RDCNT" columnIndex="14"/>
		<result property="useAt" column="USE_AT" columnIndex="15"/>
		<result property="atchFileId" column="ATCH_FILE_ID" columnIndex="16"/>
		<result property="parnts" column="PARNTSCTT_NO" columnIndex="17"/>
		<result property="replyAt" column="ANSWER_AT" columnIndex="18"/>		
		<result property="replyLc" column="ANSWER_LC" columnIndex="19"/>
		<result property="sortOrdr" column="SORT_ORDR" columnIndex="19"/>
		<result property="bbsTyCode" column="BBS_TY_CODE" columnIndex="20"/>
		<result property="bbsAttrbCode" column="BBS_ATTRB_CODE" columnIndex="21"/>
		<result property="replyPosblAt" column="REPLY_POSBL_AT" columnIndex="22"/>
		<result property="fileAtchPosblAt" column="FILE_ATCH_POSBL_AT" columnIndex="23"/>
		<result property="posblAtchFileNumber" column="ATCH_POSBL_FILE_NUMBER" columnIndex="24"/>
		<result property="bbsNm" column="BBS_NM" columnIndex="25"/>
		<result property="link_url" column="LINK_URL" columnIndex="26"/>
		<result property="fileSn" column="FILE_SN" columnIndex="27"/>
		<result property="category" column="CATEGORY" columnIndex="28"/>			
		<result property="file_Extsn" column="FILE_EXTSN" columnIndex="29"/>			
		<result property="sizex" column="SIZEX" columnIndex="30"/>
		<result property="sizey" column="SIZEY" columnIndex="31"/>
		<result property="leftx" column="LEFTX" columnIndex="32"/>
		<result property="lefty" column="LEFTY" columnIndex="33"/>
		<result property="ssWords" column="SSWORDS" columnIndex="34"/>
		<result property="ceoName" column="CEONAME" columnIndex="35"/>
		<result property="telnum" column="TELNUM" columnIndex="36"/>
		<result property="email" column="EMAIL" columnIndex="37"/>
		<result property="homepage" column="HOMEPAGE" columnIndex="38"/>			
		<result property="snslink" column="SNSLINK" columnIndex="39"/>	
		<result property="nttAd" column="NTT_AD" columnIndex="40"/>		
		<result property="topx" column="TOPX" columnIndex="41"/>
		<result property="category2" column="CATEGORY2" columnIndex="42"/>
		<result property="classfication" column="CLASSFICATION" columnIndex="43"/>
		<result property="classfication2" column="CLASSFICATION2" columnIndex="44"/>
	</resultMap>

	<resultMap id="sortList" class="egovframework.goncs.bbs.service.BoardVO">
		<result property="bbsId" column="BBS_ID" columnIndex="1"/>
		<result property="nttId" column="NTT_ID" columnIndex="2"/>
		<result property="sortOrdr" column="SORT_ORDR" columnIndex="3"/>
		<result property="parnts" column="PARNTSCTT_NO" columnIndex="4"/>
		<result property="nttNo" column="NTT_NO" columnIndex="5"/>		
		<result property="replyLc" column="ANSWER_LC" columnIndex="6"/>
	</resultMap>

	<resultMap id="guestList" class="egovframework.goncs.bbs.service.BoardVO">
		<result property="bbsId" column="BBS_ID" columnIndex="1"/>
		<result property="nttId" column="NTT_ID" columnIndex="2"/>
		<result property="nttSj" column="NTT_SJ" columnIndex="3"/>
		<result property="ntcrNm" column="NTCR_NM" columnIndex="4"/>
		<result property="password" column="PASSWORD" columnIndex="5"/>
		<result property="frstRegisterPnttm" column="FRST_REGIST_PNTTM" columnIndex="6"/>
		<result property="nttCn" column="NTT_CN" columnIndex="7"/>
		<result property="useAt" column="USE_AT" columnIndex="8"/>
		<result property="frstRegisterNm" column="FRST_REGISTER_NM" columnIndex="9"/>
		<result property="frstRegisterId" column="FRST_REGISTER_ID" columnIndex="10"/>
	</resultMap>

 	<select id="BBSManageDAO.selectMaxNttId" resultClass="java.lang.Long">
 		<![CDATA[
			SELECT IFNULL(MAX(NTT_ID),0)+1 AS NTT_ID  FROM lettnbbs
 		]]>
 	</select>
 	
	<insert id="BBSManageDAO.insertBoardArticle" parameterClass="Board" >
		<selectKey resultClass="java.lang.Long" keyProperty="nttNo">
			SELECT IFNULL(MAX(SORT_ORDR),0)+1 AS NTT_NO  FROM lettnbbs
			WHERE BBS_ID = #bbsId#
		</selectKey>
		<![CDATA[
			INSERT INTO lettnbbs
			(NTT_ID, BBS_ID, NTT_SJ, NTT_CN, SORT_ORDR, 
			 NTCR_ID, NTCR_NM, PASSWORD, RDCNT, 
			 NTCE_BGNDE, NTCE_ENDDE, ANSWER_AT,  			   
			 PARNTSCTT_NO, NTT_NO, ANSWER_LC, ATCH_FILE_ID,
			 FRST_REGISTER_ID, FRST_REGIST_PNTTM, USE_AT, LINK_URL, CATEGORY, CATEGORY2, CLASSFICATION, CLASSFICATION2,
			 SIZEX, SIZEY, LEFTX, LEFTY, SSWORDS, CEONAME, TELNUM, EMAIL, HOMEPAGE, SNSLINK, NTT_AD, TOPX
			 )
			VALUES
			( #nttId#, #bbsId#, #nttSj#, #nttCn#, #nttNo#, 
			  #ntcrId#, #ntcrNm#, #password#, #inqireCo#, 
			  #ntceBgnde#, #ntceEndde#, #replyAt#, 
			  #parnts#, 1, #replyLc#, #atchFileId#,
			  #frstRegisterId#, SYSDATE(), 'Y', #link_url#, #category#, #category2#, #classfication#, #classfication2#,
			  #sizex#, #sizey#, #leftx#, #lefty#,
			  #ssWords#, #ceoName#, #telnum#, #email#, #homepage#, #snslink#, #nttAd#, #topx#
			 )			
		]]>
	</insert>
	
	<insert id="BBSManageDAO.replyBoardArticle" parameterClass="Board" >
		<selectKey resultClass="java.lang.Long" keyProperty="nttNo">
			SELECT IFNULL(MAX(NTT_NO),0)+1 AS NTT_NO  FROM lettnbbs
			WHERE BBS_ID = #bbsId# AND SORT_ORDR = #sortOrdr#
		</selectKey>			
		<![CDATA[
			INSERT INTO lettnbbs
			(NTT_ID, BBS_ID, NTT_SJ, NTT_CN, SORT_ORDR, 
			 NTCR_ID, NTCR_NM, PASSWORD, RDCNT, 
			 NTCE_BGNDE, NTCE_ENDDE, ANSWER_AT,  			   
			 PARNTSCTT_NO, NTT_NO, ANSWER_LC, ATCH_FILE_ID,
			 FRST_REGISTER_ID, FRST_REGIST_PNTTM, USE_AT, LINK_URL, TOPX
			 )
			VALUES
			( #nttId#, #bbsId#, #nttSj#, #nttCn#, #sortOrdr#, 
			  #ntcrId#, #ntcrNm#, #password#, #inqireCo#, 
			  #ntceBgnde#, #ntceEndde#, #replyAt#, 
			  #parnts#, 1, #replyLc#, #atchFileId#,
			  #frstRegisterId#, SYSDATE(), 'Y', #link_url#, 0
			 )			
		]]>
	</insert>	
	
	<select id="BBSManageDAO.selectNoticeListForSort" parameterClass="Board" resultMap="sortList">
		<![CDATA[			
			SELECT
				a.BBS_ID, a.NTT_ID, a.SORT_ORDR, a.PARNTSCTT_NO, a.NTT_NO, a.ANSWER_LC
			FROM
				lettnbbs a	
			WHERE
				a.BBS_ID = #bbsId#
			AND
				a.SORT_ORDR = #sortOrdr#
			ORDER BY  a.SORT_ORDR DESC, a.NTT_NO ASC	
		]]>						
	</select>

			
	<select id="BBSManageDAO.selectBoardArticleList" parameterClass="BoardVO" resultMap="boardList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE, d.FILE_SN, a.NTT_CN, a.CATEGORY, a.CATEGORY2, a.CLASSFICATION, a.CLASSFICATION2, a.SSWORDS,
				a.SIZEX, a.SIZEY, a.LEFTX, a.LEFTY, IFNULL(a.LINK_URL,'') LINK_URL, IFNULL(a.TOPX,0) TOPX
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			LEFT OUTER JOIN lettnfile c ON a.ATCH_FILE_ID = c.ATCH_FILE_ID AND c.USE_AT='Y'
			LEFT OUTER JOIN lettnfiledetail d ON d.ATCH_FILE_ID = c.ATCH_FILE_ID AND d.FILE_SN = (
					SELECT lettnfiledetail.FILE_SN FROM lettnfiledetail
					WHERE lettnfiledetail.ATCH_FILE_ID = c.ATCH_FILE_ID LIMIT 1 )
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isNotEmpty property="category">
				AND (a.CATEGORY = #category# or a.CATEGORY2 = #category#)
			</isNotEmpty>
		<![CDATA[			
			ORDER BY a.TOPX DESC, a.SORT_ORDR DESC, NTT_NO ASC
			LIMIT #recordCountPerPage# OFFSET #firstIndex#
		]]>				
	</select>
	
	<select id="BBSManageDAO.selectBoardArticleListCenter" parameterClass="BoardVO" resultMap="cboardList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE, d.FILE_SN, a.CATEGORY, a.SSWORDS,
				a.SIZEX, a.SIZEY, a.LEFTX, a.LEFTY, IFNULL(a.LINK_URL,'') LINK_URL, IFNULL(a.TOPX,0) TOPX
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			LEFT OUTER JOIN lettnfile c ON a.ATCH_FILE_ID = c.ATCH_FILE_ID AND c.USE_AT='Y'
			LEFT OUTER JOIN lettnfiledetail d ON d.ATCH_FILE_ID = c.ATCH_FILE_ID AND d.FILE_SN = (
					SELECT lettnfiledetail.FILE_SN FROM lettnfiledetail
					WHERE lettnfiledetail.ATCH_FILE_ID = c.ATCH_FILE_ID LIMIT 1 )
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isNotEmpty property="category">
            	AND a.CATEGORY = #category#
        	</isNotEmpty>			
		<![CDATA[			
			ORDER BY a.TOPX DESC, a.SORT_ORDR DESC, NTT_NO ASC
			LIMIT #recordCountPerPage# OFFSET #firstIndex#
		]]>				
	</select>

	<select id="BBSManageDAO.selectBoardArticleList_qna" parameterClass="BoardVO" resultMap="qnaList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE,
				(SELECT COUNT(c.NTT_ID) FROM lettnbbs c WHERE c.BBS_ID = a.BBS_ID AND c.PARNTSCTT_NO = a.NTT_ID) reply_cnt 
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>				
		<![CDATA[			
			ORDER BY a.SORT_ORDR DESC, NTT_NO ASC
			LIMIT #recordCountPerPage# OFFSET #firstIndex#
		]]>				
	</select>
			
	<select id="BBSManageDAO.selectBoardArticleList_Faq" parameterClass="BoardVO" resultMap="faqList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE, a.NTT_CN
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>				
		<![CDATA[			
			ORDER BY a.SORT_ORDR DESC, NTT_NO ASC
			LIMIT #recordCountPerPage# OFFSET #firstIndex#
		]]>				
	</select>	
	
	<select id="BBSManageDAO.selectBoardArticleListCnt" parameterClass="BoardVO" resultClass="java.lang.Integer" >
		<![CDATA[
			SELECT
				COUNT(a.NTT_ID)
			FROM
				lettnbbs a
			LEFT OUTER JOIN 
				comvnusermaster b
			ON a.FRST_REGISTER_ID = b.MBER_ID 
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>		
			<isNotEmpty property="category">
            	AND a.CATEGORY = #category#
        	</isNotEmpty>		
	</select>	
 
	<select id="BBSManageDAO.selectBoardArticle" parameterClass="BoardVO" resultMap="boardDetail" >
		<![CDATA[
			SELECT
				a.NTT_SJ, a.NTCR_ID, a.NTCR_NM, a.NTT_NO, a.NTT_CN,
				a.PASSWORD, a.FRST_REGISTER_ID, IFNULL(b.USER_NM,'empty') as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.NTCE_BGNDE, a.NTCE_ENDDE, a.RDCNT, 
				a.USE_AT, a.ATCH_FILE_ID, a.BBS_ID, a.NTT_ID,
				a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.SORT_ORDR,
				c.BBS_TY_CODE, c.BBS_ATTRB_CODE, c.REPLY_POSBL_AT, 
				c.FILE_ATCH_POSBL_AT, c.ATCH_POSBL_FILE_NUMBER, c.BBS_NM, IFNULL(a.LINK_URL,'') LINK_URL,
				e.FILE_SN, a.CATEGORY, a.CATEGORY2, a.CLASSFICATION, a.CLASSFICATION2, e.FILE_EXTSN, a.SIZEX, a.SIZEY, a.LEFTX, a.LEFTY, a.SSWORDS,
				a.CEONAME, a.TELNUM, a.EMAIL, a.HOMEPAGE, a.SNSLINK, a.NTT_AD, a.TOPX
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID 
			LEFT OUTER JOIN lettnbbsmaster c ON a.BBS_ID = c.BBS_ID		
			LEFT OUTER JOIN lettnfile d ON a.ATCH_FILE_ID = d.ATCH_FILE_ID AND d.USE_AT='Y'
			LEFT OUTER JOIN lettnfiledetail e ON e.ATCH_FILE_ID = d.ATCH_FILE_ID AND e.FILE_SN = (
					SELECT lettnfiledetail.FILE_SN FROM lettnfiledetail
					WHERE lettnfiledetail.ATCH_FILE_ID = d.ATCH_FILE_ID LIMIT 1 )	
			WHERE
				a.BBS_ID = #bbsId#	
			AND
				a.NTT_ID = #nttId#	
			LIMIT 1
		]]>				
	</select> 
	
	<select id="BBSManageDAO.selectBoardNoticeList" parameterClass="BoardVO" resultMap="boardList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE, d.FILE_SN, a.NTT_CN, a.CATEGORY, a.CATEGORY2, a.CLASSFICATION, a.CLASSFICATION2, a.SSWORDS,
				a.SIZEX, a.SIZEY, a.LEFTX, a.LEFTY, IFNULL(a.LINK_URL,'') LINK_URL, IFNULL(a.TOPX,0) TOPX
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			LEFT OUTER JOIN lettnfile c ON a.ATCH_FILE_ID = c.ATCH_FILE_ID AND c.USE_AT='Y'
			LEFT OUTER JOIN lettnfiledetail d ON d.ATCH_FILE_ID = c.ATCH_FILE_ID AND d.FILE_SN = (
					SELECT lettnfiledetail.FILE_SN FROM lettnfiledetail
					WHERE lettnfiledetail.ATCH_FILE_ID = c.ATCH_FILE_ID LIMIT 1 )
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>				
		<![CDATA[			
			ORDER BY a.TOPX DESC, a.SORT_ORDR DESC, a.NTT_NO ASC
			LIMIT 1
		]]>				
	</select>
	
	<select id="BBSManageDAO.selectBoardNoticeList2" parameterClass="BoardVO" resultMap="boardList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE, d.FILE_SN, a.NTT_CN, a.CATEGORY, a.CATEGORY2, a.CLASSFICATION, a.CLASSFICATION2, a.SSWORDS,
				a.SIZEX, a.SIZEY, a.LEFTX, a.LEFTY, IFNULL(a.LINK_URL,'') LINK_URL, IFNULL(a.TOPX,0) TOPX
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			LEFT OUTER JOIN lettnfile c ON a.ATCH_FILE_ID = c.ATCH_FILE_ID AND c.USE_AT='Y'
			LEFT OUTER JOIN lettnfiledetail d ON d.ATCH_FILE_ID = c.ATCH_FILE_ID AND d.FILE_SN = (
					SELECT lettnfiledetail.FILE_SN FROM lettnfiledetail
					WHERE lettnfiledetail.ATCH_FILE_ID = c.ATCH_FILE_ID LIMIT 1 )
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>				
		<![CDATA[			
			ORDER BY a.TOPX DESC, a.SORT_ORDR DESC, a.NTT_NO ASC
			LIMIT 1,5
		]]>				
	</select>
	
	<select id="BBSManageDAO.selectBoardNoticeList3" parameterClass="BoardVO" resultMap="boardList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE, d.FILE_SN, a.NTT_CN, a.CATEGORY, a.CATEGORY2, a.CLASSFICATION, a.CLASSFICATION2, a.SSWORDS,
				a.SIZEX, a.SIZEY, a.LEFTX, a.LEFTY, IFNULL(a.LINK_URL,'') LINK_URL, IFNULL(a.TOPX,0) TOPX
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			LEFT OUTER JOIN lettnfile c ON a.ATCH_FILE_ID = c.ATCH_FILE_ID AND c.USE_AT='Y'
			LEFT OUTER JOIN lettnfiledetail d ON d.ATCH_FILE_ID = c.ATCH_FILE_ID AND d.FILE_SN = (
					SELECT lettnfiledetail.FILE_SN FROM lettnfiledetail
					WHERE lettnfiledetail.ATCH_FILE_ID = c.ATCH_FILE_ID LIMIT 1 )
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
				AND a.NTCE_BGNDE <= DATE_FORMAT(now(), '%Y%m%d')
				AND a.NTCE_ENDDE >= DATE_FORMAT(now(), '%Y%m%d')
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>				
		<![CDATA[			
			ORDER BY a.TOPX DESC, a.SORT_ORDR DESC, a.NTT_NO ASC
			LIMIT 5
		]]>				
	</select>
	
	<select id="BBSManageDAO.selectBoardCompList" parameterClass="BoardVO" resultMap="boardList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE, d.FILE_SN, a.NTT_CN, a.CATEGORY, a.CATEGORY2, a.CLASSFICATION, a.CLASSFICATION2, a.SSWORDS,
				a.SIZEX, a.SIZEY, a.LEFTX, a.LEFTY, IFNULL(a.LINK_URL,'') LINK_URL, IFNULL(a.TOPX,0) TOPX
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			LEFT OUTER JOIN lettnfile c ON a.ATCH_FILE_ID = c.ATCH_FILE_ID AND c.USE_AT='Y'
			LEFT OUTER JOIN lettnfiledetail d ON d.ATCH_FILE_ID = c.ATCH_FILE_ID AND d.FILE_SN = (
					SELECT lettnfiledetail.FILE_SN FROM lettnfiledetail
					WHERE lettnfiledetail.ATCH_FILE_ID = c.ATCH_FILE_ID LIMIT 1 )
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>				
		<![CDATA[			
			ORDER BY a.TOPX DESC, a.SORT_ORDR DESC, a.NTT_NO ASC
			LIMIT 4
		]]>				
	</select>
	
	<select id="BBSManageDAO.selectBoardCompList2" parameterClass="BoardVO" resultMap="boardList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, IFNULL(b.USER_NM, IFNULL(a.NTCR_NM,'empty')) as FRST_REGISTER_NM,
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d') as FRST_REGIST_PNTTM,
				a.RDCNT, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.ATCH_FILE_ID,
				a.BBS_ID, a.NTCE_BGNDE, a.NTCE_ENDDE, d.FILE_SN, a.NTT_CN, a.CATEGORY, a.CATEGORY2, a.CLASSFICATION, a.CLASSFICATION2, a.SSWORDS,
				a.SIZEX, a.SIZEY, a.LEFTX, a.LEFTY, IFNULL(a.LINK_URL,'') LINK_URL, IFNULL(a.TOPX,0) TOPX
			FROM
				lettnbbs a
			LEFT OUTER JOIN comvnusermaster b ON a.FRST_REGISTER_ID = b.MBER_ID
			LEFT OUTER JOIN lettnfile c ON a.ATCH_FILE_ID = c.ATCH_FILE_ID AND c.USE_AT='Y'
			LEFT OUTER JOIN lettnfiledetail d ON d.ATCH_FILE_ID = c.ATCH_FILE_ID AND d.FILE_SN = (
					SELECT lettnfiledetail.FILE_SN FROM lettnfiledetail
					WHERE lettnfiledetail.ATCH_FILE_ID = c.ATCH_FILE_ID LIMIT 1 )
			WHERE
				a.BBS_ID = #bbsId#
				AND a.USE_AT = 'Y'
		]]>
			<isEqual prepend="AND" property="searchCnd" compareValue="0">
				<![CDATA[	a.NTT_SJ LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>
			<isEqual prepend="AND" property="searchCnd" compareValue="1">
				<![CDATA[	a.NTT_CN LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>	
			<isEqual prepend="AND" property="searchCnd" compareValue="2">
				<![CDATA[	b.USER_NM LIKE CONCAT ('%', #searchWrd#,'%') 		]]>
			</isEqual>				
		<![CDATA[			
			ORDER BY a.TOPX DESC, a.SORT_ORDR DESC, a.NTT_NO ASC
			LIMIT 4, 4
		]]>				
	</select>
 
 	<update id="BBSManageDAO.updateBoardArticle" parameterClass="Board">
 		<![CDATA[
			UPDATE lettnbbs SET 
				NTT_SJ = #nttSj#,
				NTT_CN = #nttCn#, 
				NTCR_ID = #ntcrId#,
				NTCR_NM = #ntcrNm#,
				PASSWORD = #password#,
				NTCE_BGNDE = #ntceBgnde#,		
				NTCE_ENDDE = #ntceEndde#,
				LINK_URL = #link_url#,
				CATEGORY = #category#,
				CATEGORY2 = #category2#,
				CLASSFICATION = #classfication#,
				CLASSFICATION2 = #classfication2#,
				LAST_UPDUSR_ID = #lastUpdusrId#,
				ATCH_FILE_ID = #atchFileId#,
				LAST_UPDT_PNTTM = SYSDATE(),
				SIZEX = #sizex#,
				SIZEY = #sizey#,
				LEFTX = #leftx#,
				LEFTY = #lefty#,
				SSWORDS = #ssWords#,
				CEONAME = #ceoName#,
				TELNUM = #telnum#,
				EMAIL = #email#,
				HOMEPAGE = #homepage#,
				SNSLINK = #snslink#,
				NTT_AD = #nttAd#,
				TOPX = #topx#
			WHERE BBS_ID = #bbsId#
			AND NTT_ID = #nttId#
 		]]>
 	</update>

 	<update id="BBSManageDAO.deleteBoardArticle" parameterClass="Board">
 		<![CDATA[
			UPDATE lettnbbs SET 
				NTT_SJ = #nttSj#,
				USE_AT = 'N',
				LAST_UPDUSR_ID = #lastUpdusrId#,
				LAST_UPDT_PNTTM = SYSDATE()
			WHERE BBS_ID = #bbsId#
			AND NTT_ID = #nttId#
 		]]>
 	</update>

 	<select id="BBSManageDAO.selectMaxInqireCo" resultClass="java.lang.Integer" parameterClass="BoardVO">
 		<![CDATA[
			SELECT IFNULL(MAX(RDCNT),0)+1 AS RDCNT FROM lettnbbs
			WHERE BBS_ID = #bbsId#
			AND NTT_ID = #nttId#
 		]]>
 	</select>
 	
 	<select id="BBSManageDAO.selectNoticeItemForSort" resultClass="java.lang.Long" parameterClass="Board">
 		<![CDATA[
			SELECT
				IFNULL(MAX(NTT_NO),0)+1 AS NTT_NO
			FROM
				lettnbbs	
			WHERE
				BBS_ID = #bbsId#
			AND
				SORT_ORDR = #sortOrdr#
			AND 
				NTT_ID = #nttId#	
 		]]>
 	</select> 	

 	<update id="BBSManageDAO.updateInqireCo" parameterClass="BoardVO">
 		<![CDATA[
			UPDATE lettnbbs SET 
				RDCNT = #inqireCo#,
				LAST_UPDUSR_ID = #lastUpdusrId#,
				LAST_UPDT_PNTTM = SYSDATE()
			WHERE BBS_ID = #bbsId#
			AND NTT_ID = #nttId#
 		]]>
 	</update>

	<update id="BBSManageDAO.updateSortOrder" parameterClass="BoardVO">
 		<![CDATA[
			UPDATE lettnbbs SET 
				NTT_NO = #nttNo#
			WHERE NTT_ID = #nttId#
 		]]>	
	</update>

	<select id="BBSManageDAO.selectGuestList" parameterClass="BoardVO" resultMap="guestList" >
		<![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.NTCR_NM, a.PASSWORD, 
				DATE_FORMAT(a.FRST_REGIST_PNTTM, '%Y-%m-%d %H:%i:%S') 
				as FRST_REGIST_PNTTM,
				a.NTT_CN, a.USE_AT, a.BBS_ID, b.USER_NM as FRST_REGISTER_NM, a.FRST_REGISTER_ID
			FROM
				lettnbbs a, lettnbbsmaster b
			WHERE
				a.BBS_ID = #bbsId#
			AND 
				a.FRST_REGISTER_ID = b.MBER_ID
			AND
				a.USE_AT = 'Y'
			ORDER BY a.SORT_ORDR DESC, a.NTT_NO ASC
			LIMIT #recordCountPerPage# OFFSET #firstIndex#
		]]>				
	</select>	
	
	<select id="BBSManageDAO.selectGuestListCnt" parameterClass="BoardVO" resultClass="java.lang.Integer" >
		<![CDATA[
			SELECT
				COUNT(NTT_ID)
			FROM
				lettnbbs 
			WHERE
				BBS_ID = #bbsId#	
			AND
				USE_AT = 'Y'
		]]>			
	</select>	

	<update id="BBSManageDAO.deleteGuestList" parameterClass="BoardVO">
		<![CDATA[
			UPDATE lettnbbs
			SET USE_AT = 'N'
			WHERE BBS_ID = #bbsId#
			AND NTT_ID = #nttId#
		]]>			
	</update>	
	
	<select id="BBSManageDAO.getPasswordInf" parameterClass="Board" resultClass="java.lang.String">
		<![CDATA[
			SELECT
				PASSWORD
			FROM
				lettnbbs	
			WHERE BBS_ID = #bbsId#
			AND NTT_ID = #nttId#				
		]]>
	</select>

	<select id="BBSManageDAO.getParentNttNo" parameterClass="Board" resultClass="java.lang.Long">
		<![CDATA[
			SELECT NTT_NO FROM lettnbbs
			WHERE BBS_ID = #bbsId# AND NTT_ID = #parnts#			
		]]>
	</select>
	
 	<update id="BBSManageDAO.updateOtherNttNo" parameterClass="Board">
 		<![CDATA[
			UPDATE lettnbbs SET 
				NTT_NO = NTT_NO + 1
			WHERE BBS_ID = #bbsId# AND SORT_ORDR = #sortOrdr#
			AND NTT_NO > #nttNo#
 		]]>
 	</update>
 	
 	 	<update id="BBSManageDAO.updateNttNo" parameterClass="Board">
 		<![CDATA[
			UPDATE lettnbbs SET 
				NTT_NO = #nttNo#
			WHERE BBS_ID = #bbsId# 
			AND NTT_ID = #nttId#
 		]]>
 	</update>
</sqlMap>